estim.iptw.cont$p01.lb[estim.iptw.cont$k == i] <- results.cont.iptw$p.lo[results.cont.iptw$A1 == 0 & results.cont.iptw$A2 == 1]
estim.iptw.cont$p01.ub[estim.iptw.cont$k == i] <- results.cont.iptw$p.up[results.cont.iptw$A1 == 0 & results.cont.iptw$A2 == 1]
estim.iptw.cont$p11[estim.iptw.cont$k == i] <- results.cont.iptw$p[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
estim.iptw.cont$p11.se[estim.iptw.cont$k == i] <- results.cont.iptw$sd.p[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
estim.iptw.cont$p11.lb[estim.iptw.cont$k == i] <- results.cont.iptw$p.lo[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
estim.iptw.cont$p11.ub[estim.iptw.cont$k == i] <- results.cont.iptw$p.up[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
# RD
estim.iptw.cont$RD_A1_A2is0[estim.iptw.cont$k == i] <- results.cont.iptw$RD.A1[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 0]
estim.iptw.cont$RD_A1_A2is0.se[estim.iptw.cont$k == i] <- results.cont.iptw$sd.RD.A1[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 0]
estim.iptw.cont$RD_A1_A2is0.lb[estim.iptw.cont$k == i] <- results.cont.iptw$RD.A1.lo[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 0]
estim.iptw.cont$RD_A1_A2is0.ub[estim.iptw.cont$k == i] <- results.cont.iptw$RD.A1.up[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 0]
estim.iptw.cont$RD_A1_A2is1[estim.iptw.cont$k == i] <- results.cont.iptw$RD.A1[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
estim.iptw.cont$RD_A1_A2is1.se[estim.iptw.cont$k == i] <- results.cont.iptw$sd.RD.A1[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
estim.iptw.cont$RD_A1_A2is1.lb[estim.iptw.cont$k == i] <- results.cont.iptw$RD.A1.lo[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
estim.iptw.cont$RD_A1_A2is1.ub[estim.iptw.cont$k == i] <- results.cont.iptw$RD.A1.up[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
estim.iptw.cont$RD_A2_A1is0[estim.iptw.cont$k == i] <- results.cont.iptw$RD.A2[results.cont.iptw$A1 == 0 & results.cont.iptw$A2 == 1]
estim.iptw.cont$RD_A2_A1is0.se[estim.iptw.cont$k == i] <- results.cont.iptw$sd.RD.A2[results.cont.iptw$A1 == 0 & results.cont.iptw$A2 == 1]
estim.iptw.cont$RD_A2_A1is0.lb[estim.iptw.cont$k == i] <- results.cont.iptw$RD.A2.lo[results.cont.iptw$A1 == 0 & results.cont.iptw$A2 == 1]
estim.iptw.cont$RD_A2_A1is0.ub[estim.iptw.cont$k == i] <- results.cont.iptw$RD.A2.up[results.cont.iptw$A1 == 0 & results.cont.iptw$A2 == 1]
estim.iptw.cont$RD_A2_A1is1[estim.iptw.cont$k == i] <- results.cont.iptw$RD.A2[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
estim.iptw.cont$RD_A2_A1is1.se[estim.iptw.cont$k == i] <- results.cont.iptw$sd.RD.A2[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
estim.iptw.cont$RD_A2_A1is1.lb[estim.iptw.cont$k == i] <- results.cont.iptw$RD.A2.lo[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
estim.iptw.cont$RD_A2_A1is1.ub[estim.iptw.cont$k == i] <- results.cont.iptw$RD.A2.up[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
# a.INT
estim.iptw.cont$a.INT[estim.iptw.cont$k == i] <- results.cont.iptw$a.INT[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
estim.iptw.cont$a.INT.se[estim.iptw.cont$k == i] <- results.cont.iptw$sd.a.INT[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
estim.iptw.cont$a.INT.lb[estim.iptw.cont$k == i] <- results.cont.iptw$a.INT.lo[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
estim.iptw.cont$a.INT.ub[estim.iptw.cont$k == i] <- results.cont.iptw$a.INT.up[results.cont.iptw$A1 == 1 & results.cont.iptw$A2 == 1]
## g-computation estimation
Ycont.gcomp <- int.ltmleMSM(data = subset(df.simu, select = -c(Y.bin)),
Qform = Q_form_Ycont,
gform = g_form,
Anodes = c("fact.A1", "fact.A2"),
Lnodes = c("conf1", "conf2", "conf3"),
Ynodes = c("Y.cont"),
SL.library = list(Q=list("glm"),g=list("glm")),
gcomp = TRUE,
iptw.only = FALSE,
survivalOutcome = FALSE,
variance.method = "ic",
B = 200)
results.cont.gcomp <- estim.int.effects(Ycont.gcomp, estimator = "gcomp")$int.r
# save results
# p
estim.gcomp.cont$p00[estim.gcomp.cont$k == i] <- results.cont.gcomp$p[results.cont.gcomp$A1 == 0 & results.cont.gcomp$A2 == 0]
estim.gcomp.cont$p00.se[estim.gcomp.cont$k == i] <- results.cont.gcomp$sd.p[results.cont.gcomp$A1 == 0 & results.cont.gcomp$A2 == 0]
estim.gcomp.cont$p00.lb[estim.gcomp.cont$k == i] <- results.cont.gcomp$p.lo[results.cont.gcomp$A1 == 0 & results.cont.gcomp$A2 == 0]
estim.gcomp.cont$p00.ub[estim.gcomp.cont$k == i] <- results.cont.gcomp$p.up[results.cont.gcomp$A1 == 0 & results.cont.gcomp$A2 == 0]
estim.gcomp.cont$p10[estim.gcomp.cont$k == i] <- results.cont.gcomp$p[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 0]
estim.gcomp.cont$p10.se[estim.gcomp.cont$k == i] <- results.cont.gcomp$sd.p[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 0]
estim.gcomp.cont$p10.lb[estim.gcomp.cont$k == i] <- results.cont.gcomp$p.lo[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 0]
estim.gcomp.cont$p10.ub[estim.gcomp.cont$k == i] <- results.cont.gcomp$p.up[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 0]
estim.gcomp.cont$p01[estim.gcomp.cont$k == i] <- results.cont.gcomp$p[results.cont.gcomp$A1 == 0 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$p01.se[estim.gcomp.cont$k == i] <- results.cont.gcomp$sd.p[results.cont.gcomp$A1 == 0 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$p01.lb[estim.gcomp.cont$k == i] <- results.cont.gcomp$p.lo[results.cont.gcomp$A1 == 0 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$p01.ub[estim.gcomp.cont$k == i] <- results.cont.gcomp$p.up[results.cont.gcomp$A1 == 0 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$p11[estim.gcomp.cont$k == i] <- results.cont.gcomp$p[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$p11.se[estim.gcomp.cont$k == i] <- results.cont.gcomp$sd.p[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$p11.lb[estim.gcomp.cont$k == i] <- results.cont.gcomp$p.lo[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$p11.ub[estim.gcomp.cont$k == i] <- results.cont.gcomp$p.up[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
# RD
estim.gcomp.cont$RD_A1_A2is0[estim.gcomp.cont$k == i] <- results.cont.gcomp$RD.A1[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 0]
estim.gcomp.cont$RD_A1_A2is0.se[estim.gcomp.cont$k == i] <- results.cont.gcomp$sd.RD.A1[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 0]
estim.gcomp.cont$RD_A1_A2is0.lb[estim.gcomp.cont$k == i] <- results.cont.gcomp$RD.A1.lo[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 0]
estim.gcomp.cont$RD_A1_A2is0.ub[estim.gcomp.cont$k == i] <- results.cont.gcomp$RD.A1.up[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 0]
estim.gcomp.cont$RD_A1_A2is1[estim.gcomp.cont$k == i] <- results.cont.gcomp$RD.A1[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$RD_A1_A2is1.se[estim.gcomp.cont$k == i] <- results.cont.gcomp$sd.RD.A1[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$RD_A1_A2is1.lb[estim.gcomp.cont$k == i] <- results.cont.gcomp$RD.A1.lo[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$RD_A1_A2is1.ub[estim.gcomp.cont$k == i] <- results.cont.gcomp$RD.A1.up[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$RD_A2_A1is0[estim.gcomp.cont$k == i] <- results.cont.gcomp$RD.A2[results.cont.gcomp$A1 == 0 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$RD_A2_A1is0.se[estim.gcomp.cont$k == i] <- results.cont.gcomp$sd.RD.A2[results.cont.gcomp$A1 == 0 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$RD_A2_A1is0.lb[estim.gcomp.cont$k == i] <- results.cont.gcomp$RD.A2.lo[results.cont.gcomp$A1 == 0 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$RD_A2_A1is0.ub[estim.gcomp.cont$k == i] <- results.cont.gcomp$RD.A2.up[results.cont.gcomp$A1 == 0 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$RD_A2_A1is1[estim.gcomp.cont$k == i] <- results.cont.gcomp$RD.A2[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$RD_A2_A1is1.se[estim.gcomp.cont$k == i] <- results.cont.gcomp$sd.RD.A2[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$RD_A2_A1is1.lb[estim.gcomp.cont$k == i] <- results.cont.gcomp$RD.A2.lo[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$RD_A2_A1is1.ub[estim.gcomp.cont$k == i] <- results.cont.gcomp$RD.A2.up[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
# a.INT
estim.gcomp.cont$a.INT[estim.gcomp.cont$k == i] <- results.cont.gcomp$a.INT[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$a.INT.se[estim.gcomp.cont$k == i] <- results.cont.gcomp$sd.a.INT[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$a.INT.lb[estim.gcomp.cont$k == i] <- results.cont.gcomp$a.INT.lo[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
estim.gcomp.cont$a.INT.ub[estim.gcomp.cont$k == i] <- results.cont.gcomp$a.INT.up[results.cont.gcomp$A1 == 1 & results.cont.gcomp$A2 == 1]
}
# save simulation results
saveRDS(estim.gcomp.cont, file = "./docs/estim_gcomp_cont")
saveRDS(estim.iptw.cont, file = "./docs/estim_iptw_cont")
saveRDS(estim.tmle.cont, file = "./docs/estim_tmle_cont")
estim_gcomp_cont <- readRDS(file = "./docs/estim_gcomp_cont")
estim_iptw_cont <- readRDS(file = "./docs/estim_iptw_cont")
estim_tmle_cont <- readRDS(file = "./docs/estim_tmle_cont")
perf.gcomp.cont <- data.frame(bias = rep(NA, 15),
var = rep(NA, 15),
std.bias = rep(NA, 15),
mse = rep(NA, 15),
av.estim.se = rep(NA, 15),
cov = rep(NA, 15))
row.names(perf.gcomp.cont) <- c("p00","p10","p01","p11",
"RD_A1_A2is0","RD_A1_A2is1","RD_A2_A1is0","RD_A2_A1is1","a.INT")
perf.gcomp.cont <- data.frame(bias = rep(NA, 9),
var = rep(NA, 9),
std.bias = rep(NA, 9),
mse = rep(NA, 9),
av.estim.se = rep(NA, 9),
cov = rep(NA, 9))
row.names(perf.gcomp.cont) <- c("p00","p10","p01","p11",
"RD_A1_A2is0","RD_A1_A2is1","RD_A2_A1is0","RD_A2_A1is1","a.INT")
perf.iptw.cont <- perf.tmle.cont <- perf.gcomp.cont
## performance summary - gcomp
# p00
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p00")] <- mean(estim_gcomp_cont$p00) - E.Y00
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p00")] <- mean((estim_gcomp_cont$p00 - mean(estim_gcomp_cont$p00))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "p00")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p00")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p00")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "p00")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p00")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p00")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "p00")] <- sqrt(mean(estim_gcomp_cont$p00.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "p00")] <- mean(as.numeric(E.Y00 >= estim_gcomp_cont$p00.lb) & (E.Y00 <= estim_gcomp_cont$p00.ub))
# p10
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p10")] <- mean(estim_gcomp_cont$p10) - E.Y10
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p10")] <- mean((estim_gcomp_cont$p10 - mean(estim_gcomp_cont$p10))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "p10")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p10")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p10")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "p10")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p10")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p10")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "p10")] <- sqrt(mean(estim_gcomp_cont$p10.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "p10")] <- mean(as.numeric(E.Y10 >= estim_gcomp_cont$p10.lb) & (E.Y10 <= estim_gcomp_cont$p10.ub))
# p01
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p01")] <- mean(estim_gcomp_cont$p01) - E.Y01
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p01")] <- mean((estim_gcomp_cont$p01 - mean(estim_gcomp_cont$p01))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "p01")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p01")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p01")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "p01")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p01")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p01")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "p01")] <- sqrt(mean(estim_gcomp_cont$p01.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "p01")] <- mean(as.numeric(E.Y01 >= estim_gcomp_cont$p01.lb) & (E.Y01 <= estim_gcomp_cont$p01.ub))
# p11
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p11")] <- mean(estim_gcomp_cont$p11) - E.Y11
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p11")] <- mean((estim_gcomp_cont$p11 - mean(estim_gcomp_cont$p11))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "p11")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p11")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p11")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "p11")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p11")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p11")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "p11")] <- sqrt(mean(estim_gcomp_cont$p11.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "p11")] <- mean(as.numeric(E.Y11 >= estim_gcomp_cont$p11.lb) & (E.Y11 <= estim_gcomp_cont$p11.ub))
# RD_A1_A2is0
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] <- mean(estim_gcomp_cont$RD_A1_A2is0) - RD.cont_A1_A2is0
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] <- mean((estim_gcomp_cont$RD_A1_A2is0 - mean(estim_gcomp_cont$RD_A1_A2is0))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] <- sqrt(mean(estim_gcomp_cont$RD_A1_A2is0.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] <- mean(as.numeric(RD.cont_A1_A2is0 >= estim_gcomp_cont$RD_A1_A2is0.lb) & (RD.cont_A1_A2is0 <= estim_gcomp_cont$RD_A1_A2is0.ub))
# RD_A1_A2is1
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] <- mean(estim_gcomp_cont$RD_A1_A2is1) - RD.cont_A1_A2is1
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] <- mean((estim_gcomp_cont$RD_A1_A2is1 - mean(estim_gcomp_cont$RD_A1_A2is1))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] <- sqrt(mean(estim_gcomp_cont$RD_A1_A2is1.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] <- mean(as.numeric(RD.cont_A1_A2is1 >= estim_gcomp_cont$RD_A1_A2is1.lb) & (RD.cont_A1_A2is1 <= estim_gcomp_cont$RD_A1_A2is1.ub))
# RD_A2_A1is0
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] <- mean(estim_gcomp_cont$RD_A2_A1is0) - RD.cont_A2_A1is0
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] <- mean((estim_gcomp_cont$RD_A2_A1is0 - mean(estim_gcomp_cont$RD_A2_A1is0))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] <- sqrt(mean(estim_gcomp_cont$RD_A2_A1is0.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] <- mean(as.numeric(RD.cont_A2_A1is0 >= estim_gcomp_cont$RD_A2_A1is0.lb) & (RD.cont_A2_A1is0 <= estim_gcomp_cont$RD_A2_A1is0.ub))
# RD_A2_A1is1
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] <- mean(estim_gcomp_cont$RD_A2_A1is1) - RD.cont_A2_A1is1
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] <- mean((estim_gcomp_cont$RD_A2_A1is1 - mean(estim_gcomp_cont$RD_A2_A1is1))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] <- sqrt(mean(estim_gcomp_cont$RD_A2_A1is.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] <- mean(as.numeric(RD.cont_A2_A1is1 >= estim_gcomp_cont$RD_A2_A1is1.lb) & (RD.cont_A2_A1is1 <= estim_gcomp_cont$RD_A2_A1is1.ub))
# a.INT
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "a.INT")] <- mean(estim_gcomp_cont$a.INT) - a.INT.cont
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "a.INT")] <- mean((estim_gcomp_cont$a.INT - mean(estim_gcomp_cont$a.INT))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "a.INT")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "a.INT")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "a.INT")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "a.INT")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "a.INT")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "a.INT")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "a.INT")] <- sqrt(mean(estim_gcomp_cont$a.INT.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "a.INT")] <- mean(as.numeric(a.INT.cont >= estim_gcomp_cont$a.INT.lb) & (a.INT.cont <= estim_gcomp_cont$a.INT.ub))
## performance summary - IPTW
# p00
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p00")] <- mean(estim_iptw_cont$p00) - E.Y00
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p00")] <- mean((estim_iptw_cont$p00 - mean(estim_iptw_cont$p00))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "p00")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p00")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p00")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "p00")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p00")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p00")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "p00")] <- sqrt(mean(estim_iptw_cont$p00.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "p00")] <- mean(as.numeric(E.Y00 >= estim_iptw_cont$p00.lb) & (E.Y00 <= estim_iptw_cont$p00.ub))
# p10
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p10")] <- mean(estim_iptw_cont$p10) - E.Y10
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p10")] <- mean((estim_iptw_cont$p10 - mean(estim_iptw_cont$p10))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "p10")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p10")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p10")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "p10")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p10")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p10")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "p10")] <- sqrt(mean(estim_iptw_cont$p10.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "p10")] <- mean(as.numeric(E.Y10 >= estim_iptw_cont$p10.lb) & (E.Y10 <= estim_iptw_cont$p10.ub))
# p01
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p01")] <- mean(estim_iptw_cont$p01) - E.Y01
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p01")] <- mean((estim_iptw_cont$p01 - mean(estim_iptw_cont$p01))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "p01")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p01")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p01")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "p01")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p01")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p01")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "p01")] <- sqrt(mean(estim_iptw_cont$p01.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "p01")] <- mean(as.numeric(E.Y01 >= estim_iptw_cont$p01.lb) & (E.Y01 <= estim_iptw_cont$p01.ub))
# p11
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p11")] <- mean(estim_iptw_cont$p11) - E.Y11
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p11")] <- mean((estim_iptw_cont$p11 - mean(estim_iptw_cont$p11))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "p11")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p11")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p11")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "p11")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p11")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p11")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "p11")] <- sqrt(mean(estim_iptw_cont$p11.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "p11")] <- mean(as.numeric(E.Y11 >= estim_iptw_cont$p11.lb) & (E.Y11 <= estim_iptw_cont$p11.ub))
# RD_A1_A2is0
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] <- mean(estim_iptw_cont$RD_A1_A2is0) - RD.cont_A1_A2is0
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] <- mean((estim_iptw_cont$RD_A1_A2is0 - mean(estim_iptw_cont$RD_A1_A2is0))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] <- sqrt(mean(estim_iptw_cont$RD_A1_A2is0.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] <- mean(as.numeric(RD.cont_A1_A2is0 >= estim_iptw_cont$RD_A1_A2is0.lb) & (RD.cont_A1_A2is0 <= estim_iptw_cont$RD_A1_A2is0.ub))
# RD_A1_A2is1
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] <- mean(estim_iptw_cont$RD_A1_A2is1) - RD.cont_A1_A2is1
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] <- mean((estim_iptw_cont$RD_A1_A2is1 - mean(estim_iptw_cont$RD_A1_A2is1))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] <- sqrt(mean(estim_iptw_cont$RD_A1_A2is1.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] <- mean(as.numeric(RD.cont_A1_A2is1 >= estim_iptw_cont$RD_A1_A2is1.lb) & (RD.cont_A1_A2is1 <= estim_iptw_cont$RD_A1_A2is1.ub))
# RD_A2_A1is0
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] <- mean(estim_iptw_cont$RD_A2_A1is0) - RD.cont_A2_A1is0
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] <- mean((estim_iptw_cont$RD_A2_A1is0 - mean(estim_iptw_cont$RD_A2_A1is0))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] <- sqrt(mean(estim_iptw_cont$RD_A2_A1is0.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] <- mean(as.numeric(RD.cont_A2_A1is0 >= estim_iptw_cont$RD_A2_A1is0.lb) & (RD.cont_A2_A1is0 <= estim_iptw_cont$RD_A2_A1is0.ub))
# RD_A2_A1is1
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] <- mean(estim_iptw_cont$RD_A2_A1is1) - RD.cont_A2_A1is1
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] <- mean((estim_iptw_cont$RD_A2_A1is1 - mean(estim_iptw_cont$RD_A2_A1is1))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] <- sqrt(mean(estim_iptw_cont$RD_A2_A1is1.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] <- mean(as.numeric(RD.cont_A2_A1is1 >= estim_iptw_cont$RD_A2_A1is1.lb) & (RD.cont_A2_A1is1 <= estim_iptw_cont$RD_A2_A1is1.ub))
# a.INT
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "a.INT")] <- mean(estim_iptw_cont$a.INT) - a.INT.cont
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "a.INT")] <- mean((estim_iptw_cont$a.INT - mean(estim_iptw_cont$a.INT))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "a.INT")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "a.INT")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "a.INT")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "a.INT")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "a.INT")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "a.INT")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "a.INT")] <- sqrt(mean(estim_iptw_cont$a.INT.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "a.INT")] <- mean(as.numeric(a.INT.cont >= estim_iptw_cont$a.INT.lb) & (a.INT.cont <= estim_iptw_cont$a.INT.ub))
## performance summary - TMLE
# p00
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p00")] <- mean(estim_tmle_cont$p00) - E.Y00
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p00")] <- mean((estim_tmle_cont$p00 - mean(estim_tmle_cont$p00))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "p00")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p00")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p00")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "p00")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p00")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p00")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "p00")] <- sqrt(mean(estim_tmle_cont$p00.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "p00")] <- mean(as.numeric(E.Y00 >= estim_tmle_cont$p00.lb) & (E.Y00 <= estim_tmle_cont$p00.ub))
# p10
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p10")] <- mean(estim_tmle_cont$p10) - E.Y10
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p10")] <- mean((estim_tmle_cont$p10 - mean(estim_tmle_cont$p10))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "p10")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p10")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p10")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "p10")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p10")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p10")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "p10")] <- sqrt(mean(estim_tmle_cont$p10.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "p10")] <- mean(as.numeric(E.Y10 >= estim_tmle_cont$p10.lb) & (E.Y10 <= estim_tmle_cont$p10.ub))
# p01
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p01")] <- mean(estim_tmle_cont$p01) - E.Y01
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p01")] <- mean((estim_tmle_cont$p01 - mean(estim_tmle_cont$p01))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "p01")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p01")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p01")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "p01")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p01")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p01")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "p01")] <- sqrt(mean(estim_tmle_cont$p01.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "p01")] <- mean(as.numeric(E.Y01 >= estim_tmle_cont$p01.lb) & (E.Y01 <= estim_tmle_cont$p01.ub))
# p11
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p11")] <- mean(estim_tmle_cont$p11) - E.Y11
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p11")] <- mean((estim_tmle_cont$p11 - mean(estim_tmle_cont$p11))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "p11")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p11")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p11")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "p11")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p11")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p11")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "p11")] <- sqrt(mean(estim_tmle_cont$p11.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "p11")] <- mean(as.numeric(E.Y11 >= estim_tmle_cont$p11.lb) & (E.Y11 <= estim_tmle_cont$p11.ub))
# RD_A1_A2is0
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] <- mean(estim_tmle_cont$RD_A1_A2is0) - RD.cont_A1_A2is0
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] <- mean((estim_tmle_cont$RD_A1_A2is0 - mean(estim_tmle_cont$RD_A1_A2is0))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] <- sqrt(mean(estim_tmle_cont$RD_A1_A2is0.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] <- mean(as.numeric(RD.cont_A1_A2is0 >= estim_tmle_cont$RD_A1_A2is0.lb) & (RD.cont_A1_A2is0 <= estim_tmle_cont$RD_A1_A2is0.ub))
# RD_A1_A2is1
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] <- mean(estim_tmle_cont$RD_A1_A2is1) - RD.cont_A1_A2is1
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] <- mean((estim_tmle_cont$RD_A1_A2is1 - mean(estim_tmle_cont$RD_A1_A2is1))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] <- sqrt(mean(estim_tmle_cont$RD_A1_A2is1.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] <- mean(as.numeric(RD.cont_A1_A2is1 >= estim_tmle_cont$RD_A1_A2is1.lb) & (RD.cont_A1_A2is1 <= estim_tmle_cont$RD_A1_A2is1.ub))
# RD_A2_A1is0
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] <- mean(estim_tmle_cont$RD_A2_A1is0) - RD.cont_A2_A1is0
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] <- mean((estim_tmle_cont$RD_A2_A1is0 - mean(estim_tmle_cont$RD_A2_A1is0))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] <- sqrt(mean(estim_tmle_cont$RD_A2_A1is0.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] <- mean(as.numeric(RD.cont_A2_A1is0 >= estim_tmle_cont$RD_A2_A1is0.lb) & (RD.cont_A2_A1is0 <= estim_tmle_cont$RD_A2_A1is0.ub))
# RD_A2_A1is1
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] <- mean(estim_tmle_cont$RD_A2_A1is1) - RD.cont_A2_A1is1
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] <- mean((estim_tmle_cont$RD_A2_A1is1 - mean(estim_tmle_cont$RD_A2_A1is1))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] <- sqrt(mean(estim_tmle_cont$RD_A2_A1is1.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] <- mean(as.numeric(RD.cont_A2_A1is1 >= estim_tmle_cont$RD_A2_A1is1.lb) & (RD.cont_A2_A1is1 <= estim_tmle_cont$RD_A2_A1is1.ub))
# a.INT
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "a.INT")] <- mean(estim_tmle_cont$a.INT) - a.INT.cont
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "a.INT")] <- mean((estim_tmle_cont$a.INT - mean(estim_tmle_cont$a.INT))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "a.INT")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "a.INT")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "a.INT")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "a.INT")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "a.INT")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "a.INT")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "a.INT")] <- sqrt(mean(estim_tmle_cont$a.INT.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "a.INT")] <- mean(as.numeric(a.INT.cont >= estim_tmle_cont$a.INT.lb) & (a.INT.cont <= estim_tmle_cont$a.INT.ub))
# save simulation results
saveRDS(perf.gcomp.cont, file = "./docs/perf_gcomp_cont")
saveRDS(perf.iptw.cont, file = "./docs/perf_iptw_cont")
saveRDS(perf.tmle.cont, file = "./docs/perf_tmle_cont")
perf.gcomp
perf.iptw
perf.tmle
perf.gcomp.cont
perf.iptw.cont
perf.tmle.cont
estim_gcomp_cont
summary()
summary(estim_gcomp_cont)
## performance summary - gcomp
# p00
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p00")] <- mean(estim_gcomp_cont$p00) - E.Y00
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p00")] <- mean((estim_gcomp_cont$p00 - mean(estim_gcomp_cont$p00))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "p00")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p00")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p00")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "p00")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p00")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p00")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "p00")] <- sqrt(mean(estim_gcomp_cont$p00.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "p00")] <- mean(as.numeric(E.Y00 >= estim_gcomp_cont$p00.lb) & (E.Y00 <= estim_gcomp_cont$p00.ub))
# p10
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p10")] <- mean(estim_gcomp_cont$p10) - E.Y10
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p10")] <- mean((estim_gcomp_cont$p10 - mean(estim_gcomp_cont$p10))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "p10")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p10")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p10")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "p10")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p10")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p10")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "p10")] <- sqrt(mean(estim_gcomp_cont$p10.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "p10")] <- mean(as.numeric(E.Y10 >= estim_gcomp_cont$p10.lb) & (E.Y10 <= estim_gcomp_cont$p10.ub))
# p01
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p01")] <- mean(estim_gcomp_cont$p01) - E.Y01
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p01")] <- mean((estim_gcomp_cont$p01 - mean(estim_gcomp_cont$p01))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "p01")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p01")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p01")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "p01")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p01")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p01")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "p01")] <- sqrt(mean(estim_gcomp_cont$p01.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "p01")] <- mean(as.numeric(E.Y01 >= estim_gcomp_cont$p01.lb) & (E.Y01 <= estim_gcomp_cont$p01.ub))
# p11
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p11")] <- mean(estim_gcomp_cont$p11) - E.Y11
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p11")] <- mean((estim_gcomp_cont$p11 - mean(estim_gcomp_cont$p11))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "p11")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p11")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p11")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "p11")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "p11")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "p11")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "p11")] <- sqrt(mean(estim_gcomp_cont$p11.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "p11")] <- mean(as.numeric(E.Y11 >= estim_gcomp_cont$p11.lb) & (E.Y11 <= estim_gcomp_cont$p11.ub))
# RD_A1_A2is0
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] <- mean(estim_gcomp_cont$RD_A1_A2is0) - RD.cont_A1_A2is0
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] <- mean((estim_gcomp_cont$RD_A1_A2is0 - mean(estim_gcomp_cont$RD_A1_A2is0))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] <- sqrt(mean(estim_gcomp_cont$RD_A1_A2is0.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "RD_A1_A2is0")] <- mean(as.numeric(RD.cont_A1_A2is0 >= estim_gcomp_cont$RD_A1_A2is0.lb) & (RD.cont_A1_A2is0 <= estim_gcomp_cont$RD_A1_A2is0.ub))
# RD_A1_A2is1
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] <- mean(estim_gcomp_cont$RD_A1_A2is1) - RD.cont_A1_A2is1
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] <- mean((estim_gcomp_cont$RD_A1_A2is1 - mean(estim_gcomp_cont$RD_A1_A2is1))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] <- sqrt(mean(estim_gcomp_cont$RD_A1_A2is1.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "RD_A1_A2is1")] <- mean(as.numeric(RD.cont_A1_A2is1 >= estim_gcomp_cont$RD_A1_A2is1.lb) & (RD.cont_A1_A2is1 <= estim_gcomp_cont$RD_A1_A2is1.ub))
# RD_A2_A1is0
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] <- mean(estim_gcomp_cont$RD_A2_A1is0) - RD.cont_A2_A1is0
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] <- mean((estim_gcomp_cont$RD_A2_A1is0 - mean(estim_gcomp_cont$RD_A2_A1is0))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] <- sqrt(mean(estim_gcomp_cont$RD_A2_A1is0.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "RD_A2_A1is0")] <- mean(as.numeric(RD.cont_A2_A1is0 >= estim_gcomp_cont$RD_A2_A1is0.lb) & (RD.cont_A2_A1is0 <= estim_gcomp_cont$RD_A2_A1is0.ub))
# RD_A2_A1is1
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] <- mean(estim_gcomp_cont$RD_A2_A1is1) - RD.cont_A2_A1is1
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] <- mean((estim_gcomp_cont$RD_A2_A1is1 - mean(estim_gcomp_cont$RD_A2_A1is1))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] <- sqrt(mean(estim_gcomp_cont$RD_A2_A1is1.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "RD_A2_A1is1")] <- mean(as.numeric(RD.cont_A2_A1is1 >= estim_gcomp_cont$RD_A2_A1is1.lb) & (RD.cont_A2_A1is1 <= estim_gcomp_cont$RD_A2_A1is1.ub))
# a.INT
perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "a.INT")] <- mean(estim_gcomp_cont$a.INT) - a.INT.cont
perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "a.INT")] <- mean((estim_gcomp_cont$a.INT - mean(estim_gcomp_cont$a.INT))^2) * (nrow(estim_gcomp_cont)) / (nrow(estim_gcomp_cont) - 1)
perf.gcomp.cont$std.bias[which(row.names(perf.gcomp.cont) == "a.INT")] <- perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "a.INT")] / sqrt(perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "a.INT")])
perf.gcomp.cont$mse[which(row.names(perf.gcomp.cont) == "a.INT")] <- perf.gcomp.cont$var[which(row.names(perf.gcomp.cont) == "a.INT")] + (perf.gcomp.cont$bias[which(row.names(perf.gcomp.cont) == "a.INT")])^2
perf.gcomp.cont$av.estim.se[which(row.names(perf.gcomp.cont) == "a.INT")] <- sqrt(mean(estim_gcomp_cont$a.INT.se^2))
perf.gcomp.cont$cov[which(row.names(perf.gcomp.cont) == "a.INT")] <- mean(as.numeric(a.INT.cont >= estim_gcomp_cont$a.INT.lb) & (a.INT.cont <= estim_gcomp_cont$a.INT.ub))
## performance summary - IPTW
# p00
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p00")] <- mean(estim_iptw_cont$p00) - E.Y00
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p00")] <- mean((estim_iptw_cont$p00 - mean(estim_iptw_cont$p00))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "p00")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p00")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p00")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "p00")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p00")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p00")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "p00")] <- sqrt(mean(estim_iptw_cont$p00.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "p00")] <- mean(as.numeric(E.Y00 >= estim_iptw_cont$p00.lb) & (E.Y00 <= estim_iptw_cont$p00.ub))
# p10
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p10")] <- mean(estim_iptw_cont$p10) - E.Y10
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p10")] <- mean((estim_iptw_cont$p10 - mean(estim_iptw_cont$p10))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "p10")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p10")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p10")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "p10")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p10")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p10")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "p10")] <- sqrt(mean(estim_iptw_cont$p10.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "p10")] <- mean(as.numeric(E.Y10 >= estim_iptw_cont$p10.lb) & (E.Y10 <= estim_iptw_cont$p10.ub))
# p01
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p01")] <- mean(estim_iptw_cont$p01) - E.Y01
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p01")] <- mean((estim_iptw_cont$p01 - mean(estim_iptw_cont$p01))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "p01")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p01")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p01")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "p01")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p01")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p01")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "p01")] <- sqrt(mean(estim_iptw_cont$p01.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "p01")] <- mean(as.numeric(E.Y01 >= estim_iptw_cont$p01.lb) & (E.Y01 <= estim_iptw_cont$p01.ub))
# p11
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p11")] <- mean(estim_iptw_cont$p11) - E.Y11
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p11")] <- mean((estim_iptw_cont$p11 - mean(estim_iptw_cont$p11))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "p11")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p11")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p11")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "p11")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "p11")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "p11")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "p11")] <- sqrt(mean(estim_iptw_cont$p11.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "p11")] <- mean(as.numeric(E.Y11 >= estim_iptw_cont$p11.lb) & (E.Y11 <= estim_iptw_cont$p11.ub))
# RD_A1_A2is0
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] <- mean(estim_iptw_cont$RD_A1_A2is0) - RD.cont_A1_A2is0
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] <- mean((estim_iptw_cont$RD_A1_A2is0 - mean(estim_iptw_cont$RD_A1_A2is0))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] <- sqrt(mean(estim_iptw_cont$RD_A1_A2is0.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "RD_A1_A2is0")] <- mean(as.numeric(RD.cont_A1_A2is0 >= estim_iptw_cont$RD_A1_A2is0.lb) & (RD.cont_A1_A2is0 <= estim_iptw_cont$RD_A1_A2is0.ub))
# RD_A1_A2is1
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] <- mean(estim_iptw_cont$RD_A1_A2is1) - RD.cont_A1_A2is1
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] <- mean((estim_iptw_cont$RD_A1_A2is1 - mean(estim_iptw_cont$RD_A1_A2is1))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] <- sqrt(mean(estim_iptw_cont$RD_A1_A2is1.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "RD_A1_A2is1")] <- mean(as.numeric(RD.cont_A1_A2is1 >= estim_iptw_cont$RD_A1_A2is1.lb) & (RD.cont_A1_A2is1 <= estim_iptw_cont$RD_A1_A2is1.ub))
# RD_A2_A1is0
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] <- mean(estim_iptw_cont$RD_A2_A1is0) - RD.cont_A2_A1is0
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] <- mean((estim_iptw_cont$RD_A2_A1is0 - mean(estim_iptw_cont$RD_A2_A1is0))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] <- sqrt(mean(estim_iptw_cont$RD_A2_A1is0.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "RD_A2_A1is0")] <- mean(as.numeric(RD.cont_A2_A1is0 >= estim_iptw_cont$RD_A2_A1is0.lb) & (RD.cont_A2_A1is0 <= estim_iptw_cont$RD_A2_A1is0.ub))
# RD_A2_A1is1
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] <- mean(estim_iptw_cont$RD_A2_A1is1) - RD.cont_A2_A1is1
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] <- mean((estim_iptw_cont$RD_A2_A1is1 - mean(estim_iptw_cont$RD_A2_A1is1))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] <- sqrt(mean(estim_iptw_cont$RD_A2_A1is1.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "RD_A2_A1is1")] <- mean(as.numeric(RD.cont_A2_A1is1 >= estim_iptw_cont$RD_A2_A1is1.lb) & (RD.cont_A2_A1is1 <= estim_iptw_cont$RD_A2_A1is1.ub))
# a.INT
perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "a.INT")] <- mean(estim_iptw_cont$a.INT) - a.INT.cont
perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "a.INT")] <- mean((estim_iptw_cont$a.INT - mean(estim_iptw_cont$a.INT))^2) * (nrow(estim_iptw_cont)) / (nrow(estim_iptw_cont) - 1)
perf.iptw.cont$std.bias[which(row.names(perf.iptw.cont) == "a.INT")] <- perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "a.INT")] / sqrt(perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "a.INT")])
perf.iptw.cont$mse[which(row.names(perf.iptw.cont) == "a.INT")] <- perf.iptw.cont$var[which(row.names(perf.iptw.cont) == "a.INT")] + (perf.iptw.cont$bias[which(row.names(perf.iptw.cont) == "a.INT")])^2
perf.iptw.cont$av.estim.se[which(row.names(perf.iptw.cont) == "a.INT")] <- sqrt(mean(estim_iptw_cont$a.INT.se^2))
perf.iptw.cont$cov[which(row.names(perf.iptw.cont) == "a.INT")] <- mean(as.numeric(a.INT.cont >= estim_iptw_cont$a.INT.lb) & (a.INT.cont <= estim_iptw_cont$a.INT.ub))
## performance summary - TMLE
# p00
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p00")] <- mean(estim_tmle_cont$p00) - E.Y00
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p00")] <- mean((estim_tmle_cont$p00 - mean(estim_tmle_cont$p00))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "p00")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p00")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p00")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "p00")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p00")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p00")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "p00")] <- sqrt(mean(estim_tmle_cont$p00.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "p00")] <- mean(as.numeric(E.Y00 >= estim_tmle_cont$p00.lb) & (E.Y00 <= estim_tmle_cont$p00.ub))
# p10
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p10")] <- mean(estim_tmle_cont$p10) - E.Y10
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p10")] <- mean((estim_tmle_cont$p10 - mean(estim_tmle_cont$p10))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "p10")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p10")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p10")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "p10")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p10")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p10")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "p10")] <- sqrt(mean(estim_tmle_cont$p10.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "p10")] <- mean(as.numeric(E.Y10 >= estim_tmle_cont$p10.lb) & (E.Y10 <= estim_tmle_cont$p10.ub))
# p01
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p01")] <- mean(estim_tmle_cont$p01) - E.Y01
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p01")] <- mean((estim_tmle_cont$p01 - mean(estim_tmle_cont$p01))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "p01")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p01")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p01")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "p01")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p01")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p01")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "p01")] <- sqrt(mean(estim_tmle_cont$p01.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "p01")] <- mean(as.numeric(E.Y01 >= estim_tmle_cont$p01.lb) & (E.Y01 <= estim_tmle_cont$p01.ub))
# p11
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p11")] <- mean(estim_tmle_cont$p11) - E.Y11
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p11")] <- mean((estim_tmle_cont$p11 - mean(estim_tmle_cont$p11))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "p11")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p11")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p11")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "p11")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "p11")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "p11")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "p11")] <- sqrt(mean(estim_tmle_cont$p11.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "p11")] <- mean(as.numeric(E.Y11 >= estim_tmle_cont$p11.lb) & (E.Y11 <= estim_tmle_cont$p11.ub))
# RD_A1_A2is0
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] <- mean(estim_tmle_cont$RD_A1_A2is0) - RD.cont_A1_A2is0
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] <- mean((estim_tmle_cont$RD_A1_A2is0 - mean(estim_tmle_cont$RD_A1_A2is0))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] <- sqrt(mean(estim_tmle_cont$RD_A1_A2is0.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "RD_A1_A2is0")] <- mean(as.numeric(RD.cont_A1_A2is0 >= estim_tmle_cont$RD_A1_A2is0.lb) & (RD.cont_A1_A2is0 <= estim_tmle_cont$RD_A1_A2is0.ub))
# RD_A1_A2is1
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] <- mean(estim_tmle_cont$RD_A1_A2is1) - RD.cont_A1_A2is1
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] <- mean((estim_tmle_cont$RD_A1_A2is1 - mean(estim_tmle_cont$RD_A1_A2is1))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] <- sqrt(mean(estim_tmle_cont$RD_A1_A2is1.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "RD_A1_A2is1")] <- mean(as.numeric(RD.cont_A1_A2is1 >= estim_tmle_cont$RD_A1_A2is1.lb) & (RD.cont_A1_A2is1 <= estim_tmle_cont$RD_A1_A2is1.ub))
# RD_A2_A1is0
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] <- mean(estim_tmle_cont$RD_A2_A1is0) - RD.cont_A2_A1is0
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] <- mean((estim_tmle_cont$RD_A2_A1is0 - mean(estim_tmle_cont$RD_A2_A1is0))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] <- sqrt(mean(estim_tmle_cont$RD_A2_A1is0.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "RD_A2_A1is0")] <- mean(as.numeric(RD.cont_A2_A1is0 >= estim_tmle_cont$RD_A2_A1is0.lb) & (RD.cont_A2_A1is0 <= estim_tmle_cont$RD_A2_A1is0.ub))
# RD_A2_A1is1
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] <- mean(estim_tmle_cont$RD_A2_A1is1) - RD.cont_A2_A1is1
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] <- mean((estim_tmle_cont$RD_A2_A1is1 - mean(estim_tmle_cont$RD_A2_A1is1))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] <- sqrt(mean(estim_tmle_cont$RD_A2_A1is1.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "RD_A2_A1is1")] <- mean(as.numeric(RD.cont_A2_A1is1 >= estim_tmle_cont$RD_A2_A1is1.lb) & (RD.cont_A2_A1is1 <= estim_tmle_cont$RD_A2_A1is1.ub))
# a.INT
perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "a.INT")] <- mean(estim_tmle_cont$a.INT) - a.INT.cont
perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "a.INT")] <- mean((estim_tmle_cont$a.INT - mean(estim_tmle_cont$a.INT))^2) * (nrow(estim_tmle_cont)) / (nrow(estim_tmle_cont) - 1)
perf.tmle.cont$std.bias[which(row.names(perf.tmle.cont) == "a.INT")] <- perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "a.INT")] / sqrt(perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "a.INT")])
perf.tmle.cont$mse[which(row.names(perf.tmle.cont) == "a.INT")] <- perf.tmle.cont$var[which(row.names(perf.tmle.cont) == "a.INT")] + (perf.tmle.cont$bias[which(row.names(perf.tmle.cont) == "a.INT")])^2
perf.tmle.cont$av.estim.se[which(row.names(perf.tmle.cont) == "a.INT")] <- sqrt(mean(estim_tmle_cont$a.INT.se^2))
perf.tmle.cont$cov[which(row.names(perf.tmle.cont) == "a.INT")] <- mean(as.numeric(a.INT.cont >= estim_tmle_cont$a.INT.lb) & (a.INT.cont <= estim_tmle_cont$a.INT.ub))
# save simulation results
saveRDS(perf.gcomp.cont, file = "./docs/perf_gcomp_cont")
saveRDS(perf.iptw.cont, file = "./docs/perf_iptw_cont")
saveRDS(perf.tmle.cont, file = "./docs/perf_tmle_cont")
perf.gcomp.cont
perf.iptw.cont
perf.tmle.cont
library(MargIntTmle)
